<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Finalizar compra — VivaStore</title>
  <style>
    :root {
      --accent: #e11d2f;
      --bg: radial-gradient(circle at top, #0c0e13, #050609);
      --panel: rgba(255,255,255,0.04);
      --line: rgba(255,255,255,0.1);
      --text: #f5f5f5;
      --muted: #a5acb8;
      --success: #4be780;
      --paypal: #0070ba;
      --binance: #f3ba2f;
      --whatsapp: #25d366;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: "Poppins", sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 40px 15px;
    }

    .checkout {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 20px;
      backdrop-filter: blur(10px);
      width: 100%;
      max-width: 520px;
      padding: 40px 32px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.45);
      animation: fadeIn 0.6s ease;
    }

    @keyframes fadeIn {
      from {opacity:0; transform:translateY(20px);}
      to {opacity:1; transform:translateY(0);}
    }

    header {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .brand {
      font-size: 2.4rem;
      font-weight: 800;
      text-decoration: none;
      color: #fff;
    }
    .brand span { color: var(--accent); }

    h1 {
      text-align: center;
      font-size: 1.6rem;
      margin-bottom: 1.5rem;
    }

    .summary {
      background: rgba(255,255,255,0.05);
      border-radius: 14px;
      border: 1px solid var(--line);
      padding: 16px 18px;
      margin-bottom: 1.5rem;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      color: var(--muted);
      font-size: 0.95rem;
      margin-bottom: 6px;
    }

    .summary-total {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--line);
      font-weight: 600;
      color: var(--success);
      font-size: 1rem;
    }

    .section-title {
      font-size: 1rem;
      font-weight: 600;
      margin: 1.2rem 0 0.8rem;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 1.4rem;
    }

    label {
      font-size: 0.88rem;
      color: var(--muted);
    }

    input {
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 10px 12px;
      color: var(--text);
      font-size: 0.95rem;
      transition: border 0.3s ease;
    }

    input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .methods {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 1.8rem;
    }

    .method {
      display: flex;
      align-items: center;
      gap: 14px;
      background: rgba(255,255,255,0.05);
      border: 2px solid transparent;
      border-radius: 12px;
      padding: 12px 18px;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    .method:hover {
      background: rgba(255,255,255,0.07);
      transform: translateY(-1px);
    }

    .method-icon {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: rgba(255,255,255,0.07);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .method img {
      width: 26px;
      height: 26px;
      object-fit: contain;
    }

    .method-info {
      flex: 1;
      display: flex;
      flex-direction: column;
      line-height: 1.2;
    }

    .method-info span:first-child {
      font-weight: 600;
      font-size: 1rem;
    }

    .method-info span:last-child {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .method.active[data-method="binance"] {border-color: var(--binance);}
    .method.active[data-method="whatsapp"] {border-color: var(--whatsapp);}

    .actions {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .btn {
      height: 48px;
      border-radius: 12px;
      border: none;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: transform 0.25s ease, opacity 0.25s ease;
    }

    .btn:hover { transform: scale(1.03); }

    .btn-ghost {
      background: transparent;
      border: 1px solid var(--line);
      color: var(--text);
    }

    .btn-primary {
      background: linear-gradient(90deg, #e11d2f, #ff445c);
      color: #fff;
      box-shadow: 0 4px 14px rgba(225,29,47,0.4);
    }

    footer {
      text-align: center;
      font-size: 0.85rem;
      color: var(--muted);
      margin-top: 1.5rem;
    }

    @media (max-width: 480px) {
      .checkout { padding: 28px 22px; }
      .method-icon { width: 38px; height: 38px; }
      .brand { font-size: 2rem; }
    }
  </style>
</head>
<body>
  <div class="checkout">
    <header>
      <a href="index.html" class="brand">Viva<span>Store</span></a>
    </header>

    <h1>Finalizar compra</h1>

    <div class="summary">
      <div class="summary-item"><span>Suscripción:</span><span id="summary-item">-</span></div>
      <div class="summary-item"><span>Duración:</span><span>1 mes</span></div>
      <div class="summary-total"><span>Total:</span><span id="checkout-total">$0.00</span></div>
    </div>

    <div class="section-title">Datos del cliente</div>
    <div class="input-group">
      <label for="name">Nombre completo</label>
      <input type="text" id="name" placeholder="Ejemplo: Juan Pérez" />
      <label for="email">Correo electrónico</label>
      <input type="email" id="email" placeholder="Ejemplo: juan@gmail.com" />
    </div>

    <div class="section-title">Método de pago</div>
    <div class="methods">
      <div class="method disabled" data-method="paypal" style="opacity:0.5; cursor:not-allowed;">
        <div class="method-icon" style="background: rgba(0,112,186,0.15)">
          <img src="./img/paypal.png" alt="PayPal" />
        </div>
        <div class="method-info">
          <span>PayPal (Próximamente)</span>
          <span>Disponible muy pronto</span>
        </div>
      </div>

      <div class="method" data-method="binance">
        <div class="method-icon" style="background: rgba(243,186,47,0.15)">
          <img src="./img/binance.png" alt="Binance Pay" />
        </div>
        <div class="method-info">
          <span>Binance Pay</span>
          <span>Sin comisiones, rápido y seguro</span>
        </div>
      </div>

      <div class="method" data-method="whatsapp">
        <div class="method-icon" style="background: rgba(37,211,102,0.15)">
          <img src="./img/whatsapp.png" alt="WhatsApp" />
        </div>
        <div class="method-info">
          <span>Pago directo</span>
          <span>Coordina tu pago por WhatsApp</span>
        </div>
      </div>
    </div>

    <div class="actions">
      <button id="back-btn" class="btn btn-ghost">← Volver al carrito</button>
      <button id="continue-btn" class="btn btn-primary">Selecciona un método</button>
    </div>

    <footer>© 2025 VivaStore — Todos los derechos reservados.</footer>
  </div>

  <script>
    const totalEl = document.getElementById("checkout-total");
    const summaryItem = document.getElementById("summary-item");
    const continueBtn = document.getElementById("continue-btn");
    const savedCart = JSON.parse(localStorage.getItem("viva_cart") || "[]");
    const products = { netflix: 5.49, spotify: 3.49, disney: 5.49, hbomax: 6.49, prime: 4.49, paramount: 4.99, vix: 3.99, crunchyroll: 5.49 };
    const totalBase = savedCart.reduce((sum, i) => sum + (products[i.id] * i.qty), 0);

    // Capitaliza nombres
    const capitalize = str => str.charAt(0).toUpperCase() + str.slice(1);

    totalEl.textContent = `$${totalBase.toFixed(2)}`;
    summaryItem.textContent = savedCart.map(i => capitalize(i.id)).join(", ") || "Ninguna";

    const methods = document.querySelectorAll(".method");
    let selected = null;
    let totalFinal = totalBase;

    methods.forEach(m => {
      m.addEventListener("click", () => {
        if (m.classList.contains("disabled")) return;
        methods.forEach(x => x.classList.remove("active"));
        m.classList.add("active");
        selected = m.dataset.method;

        if (selected === "binance") {
          continueBtn.textContent = `Pagar con Binance Pay ($${totalFinal.toFixed(2)})`;
        } else if (selected === "whatsapp") {
          continueBtn.textContent = "Pagar por WhatsApp";
        }
      });
    });

    document.getElementById("back-btn").onclick = () => location.href = "index.html";

    continueBtn.addEventListener("click", () => {
      const email = document.getElementById("email").value.trim();
      const name = document.getElementById("name").value.trim();
      if (!selected) return alert("Selecciona un método de pago.");
      if (!email) return alert("Ingresa tu correo electrónico.");
      if (!name) return alert("Ingresa tu nombre completo.");

      localStorage.setItem("viva_email", email);
      localStorage.setItem("viva_name", name);
      localStorage.setItem("viva_total", totalFinal.toFixed(2));

      const capitalizedList = savedCart.map(i => capitalize(i.id)).join(", ");

      if (selected === "binance") {
        window.location.href = `/pago-binance.html?total=${totalFinal.toFixed(2)}&name=${encodeURIComponent(name)}&email=${encodeURIComponent(email)}&items=${encodeURIComponent(capitalizedList)}`;
      } else if (selected === "whatsapp") {
        const mensaje = encodeURIComponent(
          `Hola, deseo finalizar mi compra en VivaStore.\n\nSuscripción: ${capitalizedList}\nDuración: 1 mes\nTotal: $${totalFinal.toFixed(2)} USD\nCliente: ${name}\nCorreo: ${email}\nPago nacional (Honduras)`
        );
        window.open(`https://wa.me/50432736285?text=${mensaje}`, "_blank");
      }
    });
  </script>
</body>
</html>
